<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>ç®€çº¦æ–‡å­—éº»å°†</title>
    <style>
        body { font-family: 'Microsoft YaHei', sans-serif; background-color: #2d5a27; color: white; display: flex; flex-direction: column; align-items: center; padding: 20px; }
        #game-board { width: 100%; max-width: 800px; background: rgba(0,0,0,0.2); padding: 20px; border-radius: 15px; }
        .section { margin-bottom: 20px; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 10px; }
        .tile-container { display: flex; flex-wrap: wrap; gap: 8px; min-height: 50px; }
        .tile {
            width: 40px; height: 60px; background: #fff; color: #000;
            border-radius: 5px; display: flex; align-items: center; justify-content: center;
            font-weight: bold; font-size: 1.2rem; cursor: pointer; border: 2px solid #ccc;
            transition: transform 0.2s; user-select: none;
        }
        .tile:hover { transform: translateY(-5px); background: #f0f0f0; }
        .tile.new-draw { border-color: #ffeb3b; background: #fffde7; }
        .tile.discarded { width: 30px; height: 45px; font-size: 0.9rem; background: #eee; cursor: default; }
        .info { color: #ffeb3b; margin-bottom: 10px; }
        button { padding: 10px 20px; font-size: 1rem; cursor: pointer; background: #4caf50; color: white; border: none; border-radius: 5px; }
        button:hover { background: #45a049; }
    </style>
</head>
<body>

    <h1>ğŸ€„ï¸ æ–‡å­—éº»å°† (ç»ƒä¹ æ¨¡å¼)</h1>
    <div class="info">è§„åˆ™ï¼šç‚¹å‡»æ‰‹ç‰Œå³å¯å¼ƒç‰Œã€‚ç›®æ ‡ï¼šå‡‘é½æ•´é½çš„ç‰Œå‹ã€‚</div>
    
    <div id="game-board">
        <div class="section">
            <p>ç‰Œå †å‰©ä½™: <span id="deck-count">0</span></p>
            <button onclick="initGame()">é‡æ–°æ´—ç‰Œ</button>
        </div>

        <div class="section">
            <p>å¼ƒç‰Œæ± ï¼š</p>
            <div id="discards" class="tile-container"></div>
        </div>

        <div class="section">
            <p>ä½ çš„æ‰‹ç‰Œï¼š</p>
            <div id="hand" class="tile-container"></div>
        </div>

        <div class="section">
            <p>åˆšåˆšæ‘¸åˆ°çš„ç‰Œï¼š</p>
            <div id="new-tile" class="tile-container"></div>
        </div>
    </div>

    <script>
        const TYPES = ['ä¸‡', 'ç­’', 'æ¡'];
        const NUMS = ['ä¸€', 'äºŒ', 'ä¸‰', 'å››', 'äº”', 'å…­', 'ä¸ƒ', 'å…«', 'ä¹'];
        const SPECIALS = ['ä¸œ', 'å—', 'è¥¿', 'åŒ—', 'ä¸­', 'å‘', 'ç™½'];
        
        let deck = [];
        let hand = [];
        let discards = [];
        let lastDraw = null;

        // ç”Ÿæˆä¸€å‰¯ç‰Œ (136å¼ )
        function createDeck() {
            let newDeck = [];
            // ä¸‡ç­’æ¡
            for (let type of TYPES) {
                for (let num of NUMS) {
                    for (let i = 0; i < 4; i++) newDeck.push(num + type);
                }
            }
            // å­—ç‰Œ
            for (let s of SPECIALS) {
                for (let i = 0; i < 4; i++) newDeck.push(s);
            }
            return newDeck.sort(() => Math.random() - 0.5);
        }

        // æ’åºé€»è¾‘
        function sortHand(cards) {
            const order = [...SPECIALS];
            return cards.sort((a, b) => {
                const getVal = (s) => {
                    if (s.length === 1) return 100 + order.indexOf(s);
                    let typeIdx = TYPES.indexOf(s[1]);
                    let numIdx = NUMS.indexOf(s[0]);
                    return typeIdx * 10 + numIdx;
                };
                return getVal(a) - getVal(b);
            });
        }

        function initGame() {
            deck = createDeck();
            discards = [];
            lastDraw = null;
            // åˆå§‹å‘13å¼ ç‰Œ
            hand = deck.splice(0, 13);
            sortHand(hand);
            drawTile();
            render();
        }

        function drawTile() {
            if (deck.length > 0) {
                lastDraw = deck.shift();
            } else {
                alert("ç‰ŒæŠ“å®Œäº†ï¼");
            }
        }

        function discard(index, isNewTile = false) {
            let removed;
            if (isNewTile) {
                removed = lastDraw;
                lastDraw = null;
            } else {
                removed = hand.splice(index, 1);
                // æŠŠåˆšæ‰æ‘¸çš„ç‰Œæ”¾å…¥æ‰‹ç‰Œ
                if (lastDraw) {
                    hand.push(lastDraw);
                    lastDraw = null;
                }
            }
            discards.push(removed);
            sortHand(hand);
            drawTile();
            render();
        }

        function render() {
            document.getElementById('deck-count').innerText = deck.length;
            
            // æ¸²æŸ“æ‰‹ç‰Œ
            const handDiv = document.getElementById('hand');
            handDiv.innerHTML = '';
            hand.forEach((tile, index) => {
                const el = document.createElement('div');
                el.className = 'tile';
                el.innerText = tile;
                el.onclick = () => discard(index);
                handDiv.appendChild(el);
            });

            // æ¸²æŸ“æ–°æ‘¸çš„ç‰Œ
            const newTileDiv = document.getElementById('new-tile');
            newTileDiv.innerHTML = '';
            if (lastDraw) {
                const el = document.createElement('div');
                el.className = 'tile new-draw';
                el.innerText = lastDraw;
                el.onclick = () => discard(null, true);
                newTileDiv.appendChild(el);
            }

            // æ¸²æŸ“å¼ƒç‰Œ
            const discardDiv = document.getElementById('discards');
            discardDiv.innerHTML = '';
            discards.forEach(tile => {
                const el = document.createElement('div');
                el.className = 'tile discarded';
                el.innerText = tile;
                discardDiv.appendChild(el);
            });
        }

        // å¯åŠ¨æ¸¸æˆ
        initGame();
    </script>
</body>
</html>
